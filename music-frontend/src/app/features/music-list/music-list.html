<div class="max-w-[100vw] mx-auto p-6 bg-amber-100 min-h-screen pt-[15dvh]">

    <!-- Upload / Add New Music Form -->
    <div class="flex flex-col items-center">
        <div class="w-full md:max-w-[60vw] mb-10 bg-amber-50 rounded-xl shadow-md p-6">
            <h2 class="text-4xl font-semibold mb-4 text-amber-700 text-center font-extrabold">Add New Song</h2>
            <form (ngSubmit)="uploadMusic()">
                <div class="mb-4">
                    <label for="title" class="block mb-1 font-medium text-gray-700">Title</label>
                    <input id="title" type="text" [(ngModel)]="newMusicTitle" name="title" required
                        class="w-full rounded-md border border-amber-300 px-4 py-3 focus:outline-none focus:ring-2 focus:ring-amber-400 transition"
                        placeholder="Enter song Title" />
                </div>

                <div class="mb-2">
                    <label for="file"
                        class="block mb-1 font-medium text-gray-500 cursor-pointer ease-in-out active:text-gray-800 active:underline decoration-black">
                        Choose file
                    </label>
                    <input id="file" type="file" (change)="onFileSelected($event)" accept="audio/*" required
                        class="hidden" #fileInput />
                </div>

                <!-- Show selected file name -->
                <div *ngIf="selectedFile" class="text-gray-600 text-sm italic mb-4">
                    Selected file: {{ selectedFile.name }}
                </div>

                <button type="submit" class="bg-amber-600 text-amber-50 font-semibold py-2 px-6 rounded-md 
               transition duration-200 ease-in-out active:scale-95 hover:scale-105">
                    {{ isUploading ? 'Uploading...' : 'Upload' }}
                </button>
            </form>
        </div>
    </div>

    <!-- Music List Grid -->
    <div *ngIf="isLoading" class="text-center text-gray-800 text-2xl py-10">
        {{Observeapi}}
    </div>

    <div *ngIf="!isLoading && musicList.length === 0" class="text-center text-gray-800 text-2xl py-10">
        üìÇ‚ùå No music files available.
    </div>


    <div *ngIf="musicList && musicList.length > 0">
        <div class="grid gap-6 sm:grid-cols-2 lg:grid-cols-3">
            <div *ngFor="let music of musicList; let i = index"
                class="bg-white shadow-lg rounded-lg flex flex-col overflow-hidden hover:shadow-2xl transition-shadow duration-300">
                <div class="p-6 flex-grow flex flex-col">

                    <!-- Title -->
                    <h3 class="text-lg font-semibold text-gray-900 truncate mb-4" title="{{ music.Title }}">
                        {{ music.Title}}
                    </h3>

                    <!-- Audio Player -->
                    <audio controls loop #audioPlayer (play)="onPlay(i)" class="w-full rounded-md shadow-inner mb-6">
                        <source [src]="music.File" type="audio/mpeg" />
                        Your browser does not support the audio element.
                    </audio>

                    <!-- Upload Date -->
                    <p class="text-sm text-gray-500 mt-auto">
                        Uploaded on:
                        <time [attr.datetime]="music.Date">
                            {{ music.Date | date: 'mediumDate' }}
                        </time>
                    </p>
                </div>

                <!-- Delete Button -->
                <button (click)="deleteMusic(music.id)"
                    class="bg-amber-600 hover:bg-red-600 hover:cursor-pointer text-white font-semibold py-3 px-6 rounded-b-lg focus:outline-none focus:ring-2 focus:ring-red-500">
                    Delete
                </button>
            </div>
        </div>
    </div>

</div>